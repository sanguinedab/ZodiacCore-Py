"""Dependency injection container (dependency_injector). Composition root: wires infra + application only."""

from dependency_injector import containers, providers

from zodiac_core.http import ZodiacClient

from app.infrastructure.database.repositories.item_repository import ItemRepository
from app.infrastructure.external.github_client import GitHubClient
from app.application.services.item_service import ItemService
from app.application.services.github_service import GitHubService


class Container(containers.DeclarativeContainer):
    config = providers.Configuration()
    http_client = providers.Singleton(ZodiacClient)

    item_repository = providers.Factory(ItemRepository)

    item_service = providers.Factory(
        ItemService,
        item_repo=item_repository,
    )

    github_client = providers.Factory(
        GitHubClient,
        client=http_client,
    )
    github_service = providers.Factory(
        GitHubService,
        github_client=github_client,
    )

